import{j as e,L as E,C as $,a as Y,b as B,P as L,c as H,p as P,d as V,e as W,r as y,R as Z}from"./main-zD1GOUsg.js";import{b as v,i as _,c as z}from"./FinancialData-BI_1lOyY.js";$.register(Y,B,L,H,P,V,W);const G=({graph_text:b,showData:c})=>{if(!c||!Array.isArray(c)||c.length===0)return e.jsx("p",{children:"No item was selected"});const x=Array.from(new Set(c.flatMap(i=>i.dates))).sort((i,g)=>new Date(i.split("-").reverse().join("/"))-new Date(g.split("-").reverse().join("/"))),p=["#2563eb","#10b981","#f97316","#6366f1","#ec4899","#14b8a6","#ef4444","#8b5cf6","#facc15","#22c55e"],f=c.map((i,g)=>{const k=x.map(S=>{const u=i.dates.indexOf(S);return u!==-1?i.values[u]:null});return{label:i.name,data:k,borderColor:p[g%p.length],backgroundColor:"transparent",borderWidth:2,tension:.4,pointRadius:4,pointHoverRadius:6,pointBackgroundColor:p[g%p.length],pointBorderColor:"#fff",fill:!1}}),N={labels:x,datasets:f},w={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{boxWidth:10,font:{size:14,family:"'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif"},color:"#333"}},title:{display:!0,value:b,font:{size:18,weight:"bold",family:"'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif"},padding:0,margin:0},tooltip:{mode:"index",intersect:!1,backgroundColor:"#111827",titleFont:{size:14,weight:"bold"},bodyFont:{size:12},borderColor:"#ccc",borderWidth:1}},scales:{x:{ticks:{color:"#6b7280",font:{size:12}},grid:{color:"rgba(0, 0, 0, 0.05)"},title:{display:!0,text:"Date",color:"#374151",font:{size:14,weight:"600"}}},y:{ticks:{color:"#6b7280",font:{size:12},callback:function(i){return Intl.NumberFormat("en",{notation:"compact"}).format(i)}},grid:{color:"rgba(0, 0, 0, 0.05)"},title:{display:!0,text:"Value",color:"#374151",font:{size:14,weight:"600"}}}}};return e.jsx(E,{data:N,options:w})};function q({data:b}){var C;const[c,x]=y.useState({}),[p,f]=y.useState([]),[N,w]=y.useState({}),i=(s,t)=>t.every(n=>n==null||n===""||isNaN(n))?(alert(`${s} is not found.`),!1):!0,g=s=>{let t=s.target.textContent,d=v[t],n=c.balance_sheet.map(a=>a[d]),r=c.balance_sheet.map(a=>a.asOfDate);i(t,n)&&f(a=>{if(a[t]){const o={...a};return delete o[t],o}else return{...a,[t]:{value:[n],dates:[r]}}})},k=s=>{let t=s.target.textContent,d=_[t],n=c.income_statement.map(a=>a[d]),r=c.income_statement.map(a=>a.asOfDate);i(t,n)&&f(a=>{if(a[t]){const o={...a};return delete o[t],o}else return{...a,[t]:{value:[n],dates:[r]}}})},S=s=>{let t=s.target.textContent,d=z[t],n=c.cash_flow.map(a=>a[d]),r=c.cash_flow.map(a=>a.asOfDate);i(t,n)&&f(a=>{if(a[t]){const o={...a};return delete o[t],o}else return{...a,[t]:{value:[n],dates:[r]}}})};y.useEffect(()=>{b&&(x(b),f([]))},[b]);const u=Object.entries(p).map(([s,t])=>{const d=t.dates[0],n=t.value[0],r={};d.forEach(l=>{const h=new Date(l),m=String(h.getMonth()+1).padStart(2,"0")+"-"+String(h.getDate()).padStart(2,"0");r[m]=(r[m]||0)+1});const a=Object.keys(r).reduce((l,h)=>r[l]>r[h]?l:h),o=d.map((l,h)=>{const m=new Date(l),F=m.getMonth()+1,O=m.getDate(),[M,A]=a.split("-").map(Number),I=Math.abs(F-M),R=Math.abs(O-A);return I<=1&&R<=5?{date:m,year:m.getFullYear(),value:n[h]}:null}).filter(l=>l!==null);o.sort((l,h)=>l.date-h.date);const j={};o.forEach(l=>{(!j[l.year]||l.date>j[l.year].date)&&(j[l.year]=l)});const D=Object.keys(j).sort((l,h)=>l-h);return{name:s,dates:D.map(l=>j[l].date.toISOString().split("T")[0]),values:D.map(l=>j[l].value)}});return e.jsxs("div",{className:"financial_container",children:[e.jsx("div",{className:"financial_select",children:e.jsxs("ul",{children:[e.jsx("p",{className:"financial_title",children:"Balance Sheet"}),Object.keys(v).map((s,t)=>e.jsx("li",{onClick:g,className:t%2===0?"even-row":"odd-row",children:s.replace(/([a-z])([A-Z])/g,"$1 $2")},t)),e.jsx("p",{className:"financial_title",children:"Income Statement"}),Object.keys(_).map((s,t)=>e.jsx("li",{onClick:k,className:t%2===0?"even-row":"odd-row",children:s.replace(/([a-z])([A-Z])/g,"$1 $2")},t)),e.jsx("p",{className:"financial_title",children:"Cash Flow"}),Object.keys(z).map((s,t)=>e.jsx("li",{onClick:S,className:t%2===0?"even-row":"odd-row",children:s.replace(/([a-z])([A-Z])/g,"$1 $2")},t))]})}),u&&u.length>0?e.jsxs("div",{className:"financial-chart-table",children:[e.jsx("div",{className:"header-row",children:e.jsx("button",{className:"refresh-button",onClick:()=>{f([]),w({})},children:e.jsx("span",{class:"material-symbols-outlined",children:"refresh"})})}),e.jsx("div",{className:"financial-chart-wrapper",children:e.jsx(G,{graph_text:"Financial Overview",showData:u})}),e.jsx("div",{children:e.jsxs("table",{className:"financial-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"(MYR/Million)"}),(C=u[0])==null?void 0:C.dates.map((s,t)=>e.jsx("th",{children:s},t))]})}),e.jsx("tbody",{children:u.map((s,t)=>{var d;return e.jsxs(Z.Fragment,{children:[e.jsxs("tr",{onClick:()=>w(n=>({...n,[s.name]:!n[s.name]})),children:[e.jsx("td",{children:e.jsx("b",{children:s.name})}),(d=s==null?void 0:s.values)==null?void 0:d.map((n,r)=>isNaN(n)?null:e.jsx("td",{children:(n/1e6).toFixed(2)},r))]}),N[s.name]&&e.jsxs("tr",{className:"yoy-growth-row",children:[e.jsx("td",{style:{fontSize:"0.8em",textAlign:"right"},children:"YoY Growth"}),s.values.map((n,r)=>{if(r===0)return e.jsx("td",{children:"-"},r);const a=s.values[r-1];if(a===0||isNaN(n)||isNaN(a))return e.jsx("td",{},r);const o=((n/a-1)*100).toFixed(2);return e.jsxs("td",{style:{fontSize:"0.8em",color:o>=0?"green":"red",textAlign:"center"},children:[o,"%"]},r)})]})]},t)})})]})})]}):e.jsx("div",{children:e.jsx("h4",{children:"No item was Seleted"})})]})}export{q as default};
